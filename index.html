<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brain Train Hub</title>
    <style>
        :root { --bg: #000; --panel: #0a0a0a; --text: #fff; --accent: #ff0000; --brain: #ff77ff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        header { width: 100%; max-width: 1100px; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        
        /* Rank Progress Bar */
        .rank-container { width: 90%; max-width: 450px; background: #111; padding: 20px; border-radius: 20px; border: 1px solid #222; margin-bottom: 20px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .rank-header { display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 10px; }
        #rank-icon { font-size: 2rem; }
        .rank-title { font-weight: bold; color: var(--accent); font-size: 1.3rem; text-transform: uppercase; letter-spacing: 2px; }
        
        .progress-bg { width: 100%; height: 12px; background: #222; border-radius: 6px; overflow: hidden; margin-top: 10px; }
        .progress-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 0 15px var(--accent); }
        .next-rank { font-size: 0.85rem; color: #777; margin-top: 8px; font-weight: 500; }

        .brain-display { background: rgba(255, 119, 255, 0.1); padding: 8px 18px; border-radius: 12px; color: var(--brain); font-weight: bold; border: 2px solid var(--brain); display: flex; align-items: center; gap: 10px; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; width: 90%; max-width: 1100px; padding: 20px; }
        .card { background: var(--panel); border: 2px solid #1a1a1a; border-radius: 25px; padding: 30px; text-align: center; transition: 0.3s; text-decoration: none; color: white; display: flex; flex-direction: column; align-items: center; }
        .card:hover { border-color: var(--accent); transform: translateY(-8px); box-shadow: 0 12px 25px rgba(0,0,0,0.6); }
        .card-icon { font-size: 3.5rem; margin-bottom: 15px; }
        
        .btn { display: inline-block; margin-top: 20px; padding: 12px 30px; background: var(--accent); color: white; border-radius: 30px; font-weight: bold; text-decoration: none; font-size: 0.9rem; }
        
        #shop-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
        .shop-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px; }
        .shop-item { width: 65px; height: 65px; border-radius: 50%; cursor: pointer; border: 3px solid transparent; transition: 0.2s; position: relative; }
        .shop-item:hover { transform: scale(1.1); }
    </style>
</head>
<body>

    <header>
        <div style="font-size: 1.6rem; font-weight: bold; letter-spacing: -1px;">BRAIN<span style="color:var(--accent)">TRAIN</span></div>
        <div class="brain-display">
            <span style="font-size: 1.4rem;">ðŸ§ </span>
            <span id="brains">0</span>
        </div>
    </header>

    <div class="rank-container">
        <div class="rank-header">
            <span id="rank-icon">ðŸŽ“</span>
            <div id="rank-name" class="rank-title">STUDENT</div>
        </div>
        <div class="progress-bg">
            <div id="rank-progress" class="progress-fill"></div>
        </div>
        <div id="next-rank-info" class="next-rank">Next Rank at 500</div>
    </div>

    <div class="grid">
        <a href="math.html" class="card">
            <div class="card-icon">âž•</div>
            <h2 style="color:var(--accent); margin: 5px 0;">Math Train</h2>
            <p style="color: #aaa; font-size: 0.9rem;">Solve equations before the train reaches the end.</p>
            <div class="btn">START TRAINING</div>
        </a>
        <a href="grammar.html" class="card">
            <div class="card-icon">ðŸ“–</div>
            <h2 style="color:var(--accent); margin: 5px 0;">Grammar Train</h2>
            <p style="color: #aaa; font-size: 0.9rem;">Master vocabulary and opposites to win.</p>
            <div class="btn">START TRAINING</div>
        </a>
        <a href="dots.html" class="card">
            <div class="card-icon">ðŸŽ¯</div>
            <h2 style="color:var(--accent); margin: 5px 0;">Dots Reflex</h2>
            <p style="color: #aaa; font-size: 0.9rem;">Test your speed and precision by clicking dots.</p>
            <div class="btn">START TRAINING</div>
        </a>
    </div>

    <button onclick="toggleShop()" style="margin: 20px 0 40px 0; background:none; border:1px solid #333; color:#666; padding:10px 25px; border-radius:25px; cursor:pointer; font-weight: bold; transition: 0.3s;">ðŸŽ¨ OPEN SKIN SHOP</button>

    <div id="shop-overlay">
        <h2 style="letter-spacing: 2px;">SKIN SHOP</h2>
        <div class="shop-grid" id="shop-grid"></div>
        <button onclick="toggleShop()" style="margin-top:40px; color:#555; background:none; border:1px solid #444; padding: 10px 30px; border-radius: 20px; cursor:pointer;">CLOSE</button>
    </div>

    <script>
        let userBrains = parseInt(localStorage.getItem('bt_coins')) || 0;
        let unlocked = JSON.parse(localStorage.getItem('bt_skins')) || ['red'];
        let currentSkin = localStorage.getItem('bt_current_skin') || 'red';

        const colors = [
            {id:'red', hex:'#ff0000', cost:0},
            {id:'blue', hex:'#0088ff', cost:500},
            {id:'yellow', hex:'#ffcc00', cost:1000},
            {id:'green', hex:'#00ff00', cost:2000},
            {id:'purple', hex:'#9900ff', cost:5000}
        ];

        // RANK DEFINITIONS WITH ICONS
        const ranks = [
            { name: "Student", min: 0, next: 500, icon: "ðŸŽ“" },
            { name: "Scholar", min: 500, next: 2000, icon: "ðŸ“œ" },
            { name: "Genius", min: 2000, next: 5000, icon: "ðŸ’¡" },
            { name: "Mastermind", min: 5000, next: 10000, icon: "ðŸ‘‘" },
            { name: "Brain Overlord", min: 10000, next: 999999, icon: "ðŸŒŒ" }
        ];

        function updateUI() {
            document.getElementById('brains').innerText = userBrains;
            
            // Rank Logic
            let currentRank = ranks[0];
            for (let r of ranks) {
                if (userBrains >= r.min) currentRank = r;
            }
            
            document.getElementById('rank-name').innerText = currentRank.name;
            document.getElementById('rank-icon').innerText = currentRank.icon;
            
            let progress = ((userBrains - currentRank.min) / (currentRank.next - currentRank.min)) * 100;
            document.getElementById('rank-progress').style.width = Math.min(progress, 100) + "%";
            
            if (currentRank.name === "Brain Overlord") {
                document.getElementById('next-rank-info').innerText = "MAX RANK REACHED";
            } else {
                let nextRank = ranks[ranks.indexOf(currentRank) + 1];
                document.getElementById('next-rank-info').innerText = `Next: ${nextRank.name} at ${currentRank.next} ðŸ§ `;
            }

            const skin = colors.find(c => c.id === currentSkin);
            document.documentElement.style.setProperty('--accent', skin.hex);
            renderShop();
        }

        function renderShop() {
            const grid = document.getElementById('shop-grid'); grid.innerHTML = '';
            colors.forEach(c => {
                const el = document.createElement('div');
                el.className = 'shop-item'; el.style.background = c.hex;
                if(!unlocked.includes(c.id)) {
                    el.innerHTML = `<span style="color:#000; font-size:11px; display:flex; justify-content:center; align-items:center; height:100%; font-weight:bold;">${c.cost}</span>`;
                    el.onclick = () => { 
                        if(userBrains >= c.cost) { 
                            userBrains -= c.cost; 
                            unlocked.push(c.id); 
                            localStorage.setItem('bt_coins', userBrains); 
                            localStorage.setItem('bt_skins', JSON.stringify(unlocked)); 
                            updateUI(); 
                        } 
                    };
                } else {
                    if(currentSkin === c.id) el.style.borderColor = "white";
                    el.onclick = () => { 
                        currentSkin = c.id; 
                        localStorage.setItem('bt_current_skin', c.id); 
                        updateUI(); 
                    };
                }
                grid.appendChild(el);
            });
        }

        function toggleShop() {
            const s = document.getElementById('shop-overlay');
            s.style.display = (s.style.display === 'flex') ? 'none' : 'flex';
        }

        updateUI();
    </script>
</body>
</html>
